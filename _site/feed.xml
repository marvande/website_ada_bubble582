<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Tell me what you buy and I will tell you who you are</title>
    <description>Insert description here.
</description>
    <link>http://localhost:4000</link>
    <atom:link href="http://localhost:4000/feed.xml" rel="self" type="application/rss+xml"/>
    <pubDate>Wed, 18 Dec 2019 18:04:39 +0100</pubDate>
    <lastBuildDate>Wed, 18 Dec 2019 18:04:39 +0100</lastBuildDate>
    <generator>Jekyll v3.8.5</generator>
    
      <item>
        <title>Tell me what you buy, I will tell you who you are. A data story.</title>
        <description>&lt;!--Style used in the document: --&gt;
&lt;style&gt;
img {
    display: block;
    margin-left: auto;
    margin-right: auto;
}
p{
    text-align: justify;
}
&lt;/style&gt;

&lt;font size=&quot;2.5&quot;&gt;

&lt;!--PREFACE: --&gt;
&lt;h4&gt;Chapter 0. Preface.&lt;/h4&gt;
&lt;p&gt;
Due to rumours about the troublesome ability of shopping centers to infer consumer information based on their shopping patterns, a private investigator, detective Duck, was hired by a consumer advocacy group to investigate the matter. Here are the details of his investigation.
&lt;/p&gt;
 
&lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/pic08.png&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;200&quot; height=&quot;150&quot; /&gt;

&lt;p&gt;
Living in a time and age where every piece of our data is stored and analysed, the consumer advocacy group wondered what information retailers can gather and infer about consumers. Nevertheless, to answer their question, the group could only provide Detective Duck with information about a two year shopping spree of 2500 clients of an unknown shopping center based in the US. Based on this data, Duck was tasked with identifying possible links, if they exist, between demographic information (e.g. marital status, income, number of children, etc) and purchase patterns. In other words, he needed to find ou how easy it is for retailers to infer a specific customer profile based on their shopping habits. This was crucial to the consumer advocacy group as precise customer profiles lead to targeted marketing and loss of privacy. Luckily, Detective Duck followed the autumn 2019 Applied Data Analysis course at the EPFL and applied his newly aquired knowledge with diligence to this case. 

&lt;/p&gt;

&lt;br /&gt;
&lt;hr /&gt;
&lt;!--CHAPTER 1: --&gt;
&lt;h4&gt;Chapter 1. A rocky start to a rocky investigation.&lt;/h4&gt; 
&lt;p&gt;&lt;em&gt;&lt;strong&gt;A Dunnhumby dataset.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt; 

&lt;p&gt;
    The consumer advocacy group provided Detective Duck with a dataset owned by Dunhumby, an American Data Science company. This included the results of a two years long study, over 2500 voluntary households. When looking at the dataset, Duck quickly realised that this dataset was quite big and had a lot of miscellaneous information. Nevertheless, our favourite detective has learned that when faced with this challenge, one needs to start by pre-processing and cleaning the available information. For this, he kept only households which showed coherent and sufficient demographic data. Furthermore, he labelled all 10'000 products into precise grocery categories shown below. 
        
        &lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/BAD-products_trans_label.png&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;900&quot; height=&quot;700&quot; /&gt; 
&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;Know thy households.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt; 

&lt;p&gt;
   Before starting to hunt for clues, Detective Duck first had to know what kind of households were present in his data. This is where he had his first schock of the investigation. Indeed, over the 2500 households studied by Dunhumby, only 750 provided their demographic information and remained after cleaning. At this moment, suspicions started to arise in detective Duck's mind that the consumer advocacy group had provided him with quite a challenge. Undoubtetly, a small dataset would cause troubles when trying to draw predictions. Duck regretted ever leaving his cozy pond. 

&lt;/p&gt;

&lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/pic09.png&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;250&quot; height=&quot;125&quot; /&gt;
&lt;p&gt;
Still, Duck aimed to extract the client's main consumption patterns and correlate them to their demographic features. For this, he developped several strategies that will be developped below. &lt;/p&gt;

&lt;br /&gt;
&lt;hr /&gt;
&lt;!--CHAPTER 2: --&gt;
&lt;h4&gt;Chaptre 2. Profiling is not a piece of cake..&lt;/h4&gt;

&lt;p&gt;
   Once the data was ready for analysis, Detective Duck was excited to face the real challenge: customer profile hunting. 
&lt;/p&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt; A hunt for correlations.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt; 
&lt;p&gt;
   Detective Duck seekd for major correlation patterns in the whole data. After some coding, he produced the following matrix to illustrate the relation strength in between demographic features, spendings and the products quantities for the most common labels. 
&lt;/p&gt;

&lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/BAD-correlation-matrix.png&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;600&quot; height=&quot;400&quot; /&gt;

&lt;p&gt;
From this, he learned that there is some high correlation between demographic information. Specifically, household size is highly correlation to the number of kids and marital status. This did not surprise Duck as any good detective could have deduced that. Nevertheless, he noted in a part of his mind that most households with kids were married in this study. Furthermore, the mean and yearly spending were also correlated (0.7) with the different products quantities. This also did not raise any alarms, as spending more usually means buying more products in a grocery store. Nonetheless, Duck could not find any direct link between demographics and product quantities. Not satisfied with this result, he decided to pursue the matter further, as it seemed too easy. He speculated that no correlation between labels and demographics could mean that the labels were not specific enough, as all households probably just bought globally the same amount in the categories of vegetables, meat, dairy products, etc. Thus, in general, except for outliers with extreme diets, all households seem to buy from the same grocery categories. &lt;/p&gt;

&lt;iframe src=&quot;https://gfycat.com/ifr/AdmiredGlumBluebreastedkookaburra&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; width=&quot;60%&quot; height=&quot;60%&quot; style=&quot;position:absolute;top:0;left:0;&quot; allowfullscreen=&quot;&quot;&gt;
&lt;/iframe&gt;

&lt;br /&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;em&gt;&lt;strong&gt; A duck in a random forest.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt; 

&lt;p&gt;
Our favourite duck is not the kind of duck that gives up when discovering weak correlations, the consumer group hired him because he is the best in the field. Thus, he decided to follow another path and to seek help from Machine Learning, more specifically, Random Forests. He built a predictive model that would hopefully find things, he as a simple duck, could not. First, he fitted a decision tree on the monthly product quantities bought by all households with avlaible demographic information. The results for this were regretfully bad. So bad that Duck could have just randomly set a random demographic parameter for each household and the result would have been better (e.g. the ROC AUC score barely exceeded the baseline score). The same occured when fitting a random forest model. Thus, he concluded that, using only labels, there was not enough data to train a good machine learning model and infer satisfying customer profiles. Disappointed but not surprised as he had already suspected something of the sort would happen (see section &lt;i&gt;Know thy households&lt;/i&gt;), Duck resigned to pursue another investigation path, as he had not yet said his last word. 
&lt;/p&gt;

&lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/pic10.jpg&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;600&quot; height=&quot;400&quot; /&gt;

&lt;p&gt;&lt;em&gt;&lt;strong&gt;Smart clustering.&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;   
&lt;p&gt;
Duck needed to change his plan of action as he had promised to deliver. Thus, he dediced to search for typical grocery carts present in the data. From this, he hoped to be able to relate them to demographic parameters. To do this, he tossed aside the labels and focused on the products themselves. 
&lt;p&gt;
&lt;p&gt;&lt;i&gt;Being a strategic Duck&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;
At that time, he uses different strategies to cluster his data and select the most interesting one :
&lt;p&gt;
&lt;p&gt;
&lt;span&gt;&amp;#8226;&lt;/span&gt; &lt;em&gt;I)&lt;/em&gt;  His first idea is to cluster households in function of the main products they buy. He identifies the best number of clusters, which is in between 5 and 9, with elbow. Then he applies K-mean to create 7 households clusters. He uses a threshold at ⅓  of the households. Thus, a product is characterizing a cluster if and only if, at least one third of the households has bought this product. Two of the final clusters contain only one family. Interestingly 4 different clusters are characterized by the dairy products, bananas they buy. Duck wonders if the type of milk can give a hint on who is buying it. The biggest cluster, 1065 familis, is made of households buying unknown products. For the detective, it means that these households are not characterized by any common product.
&lt;p&gt;
&lt;p&gt;
&lt;span&gt;&amp;#8226;&lt;/span&gt; &lt;em&gt;II)&lt;/em&gt;  His second idea is reducing the dataset of &lt;i&gt;the average amount of products bought per label by the household&lt;/i&gt; 's dimensions using SVD. After the reduction, two dimensions explain 58% of the variance. The detective then plots the data along these two dimensions to see if he can observe some clusters. However he can not see clear clusters that could predict a certain demographic. 


&lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/BAD-corrplots.png&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;800&quot; height=&quot;600&quot; /&gt;


To make sure that this visualization does not hide any clusters, we use elbow to find a good cluster’s number. However no good clustering arise from this analysis.
&lt;p&gt;

&lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/BAD-elbow.png&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;500&quot; height=&quot;300&quot; /&gt;

&lt;p&gt;
&lt;span&gt;&amp;#8226;&lt;/span&gt; &lt;em&gt;III)&lt;/em&gt;  In a third time, Duck reproduces the second strategy but taking a step back, and looking at the department instead of the labels. Elbow finds an ideal clustering for 4 clusters. Interestingly the K-mean clustering shows 4 groups mainly characterized by the quantities bought in the grocery department. 
&lt;p&gt;
&lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/BAD-clusters.png&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;450&quot; height=&quot;225&quot; /&gt;
    

&lt;p&gt;&lt;i&gt;Best prediction further analysis&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;
Duck finally selects the third strategy, which gave the best results, and goes deeper into details. He looks at how precise it is possible to be when predicting demographics. He picks the biggest cluster and plots its correlation matrix in between the product quantities per label, the demographic features, the spendings and the participation rate. The correlations are now way stronger than within the overall households. The highest scores (around 0.8) are for the dairy products and the processed foods correlated to the households size or number of kids. Interestingly, it reminds the detective about his finding using the first strategy. Moreover, the other correlations are mainly strong but not really strong. This implies that the retailer would need to compare the households over an important number of features to acceptably predict their demographics.  
The G.A.C might be interested.
&lt;p&gt;

&lt;img class=&quot;center&quot; src=&quot;http://localhost:4000/assets/images/BAD-correlation-matrix2.png&quot; alt=&quot;Markdown Monster icon&quot; width=&quot;600&quot; height=&quot;400&quot; /&gt;

&lt;!--CHAPTER 3: --&gt;
&lt;p&gt;
&lt;h4&gt;Chaptre 3.  Time to report the results to the C.A.G.&lt;/h4&gt;
&lt;p&gt;

&lt;p&gt;&lt;i&gt;What detective Duck learned from this investigation&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;
After this investigation full of twists and turns, Duck's answer to the C.A.G is the following: 
“First of all you should not worry too much. It is not as easy to get anything interesting from people’s shopping habits, at least not at the scale of a single retailer. Retailers would need to build a clever data collection and to invest money in a data analysis professional. Indeed families are more similar than we expected, no matters in which social class they are. However, I was still able to predict some simple features, as for instance having kids or not.” 
&lt;p&gt;
&lt;p&gt;&lt;i&gt;What Duck could have done better&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;
The data collection the detective has analyzed might be atypical. Since he did not have any information about the location of the shopping center, he cannot claim that it represents the average grocery store. 
Moreover the number of households who gave their demographic features was limited. The accuracy of machine learning analysis often rely on the dataset size. Duck wonders if his work was biased by a too small dataset. 
He chose the product’s classification arbitrarily. The different labels were set depending on the common class of food he personally knew. Using a machine learning classification could have created unexpected and relevant groups of products.
&lt;p&gt;
    
&lt;p&gt;&lt;i&gt;Project next steps&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;
As further work Duck advises the C.A.G to run a meta analysis among several shopping centers, in order to confirm or infirm his conclusions. The household set for each center should preferably be bigger and the products classification should be comparable in between the different grocery stores. 
&lt;p&gt;

Good job detective Duck. The smart little guy is already gone for a new investigation.
&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/p&gt;&lt;/font&gt;
</description>
        <pubDate>Thu, 12 Dec 2019 00:00:00 +0100</pubDate>
        <link>http://localhost:4000/2019/12/12/data_story/</link>
        <guid isPermaLink="true">http://localhost:4000/2019/12/12/data_story/</guid>
        
        
      </item>
    
  </channel>
</rss>
